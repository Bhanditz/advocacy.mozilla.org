# Overview

This is the source code for [advocacy.mozilla.org]()

Currently there are three parts to the site.

[Homepage](advocacy.mozilla.org) and [Open Web Fellows](https://advocacy.mozilla.org/open-web-fellows/) are an index.html file statically generated by a server at build time. This single index page then renders the requested page on the client side.

[Encrypt Campaign](https://advocacy.mozilla.org/encrypt/) doesn't use an html file and nothing is built on the server, instead the server generates the pages as requested and passed to the client. The result page is cached on the server in memory after the first request, so the next request is not generated again.

# Getting Started

## Dependencies

To get a local version of the site running, you'll need to have [git](http://git-scm.com/) and [node](http://nodejs.org/) installed on your local machine.

## Build

To start local development, install and run the following commands:

``` bash
$ cp sample.env .env
$ npm install
$ npm start
```

## Develop Workflow

After successfully building and running the server, go to localhost:8080/

Now start changing files in /src and refresh localhost:8080/ You don't need to rerun the server, although it doesn't hurt to either.

Some server side files need the server to be rerun with npm start.

## Sitemap

```
/ -> /src/pages/home.js
/encrypt/ -> /src/pages/encrypt/index.js
/open-web-fellows/ -> /src/pages/open-web-fellows/overview.js
/open-web-fellows/info/ -> /src/pages/open-web-fellows/info.js
/open-web-fellows/fellows/ -> /src/pages/open-web-fellows/fellows.js
```

## Source Structure

We use npm scripts as the entry point to build our code and run our server. All out npm scripts and npm dependencies are stored in package.json.

Our client side source code lives in /src. Our HTML source is written in react and lives in /src/components/ and /src/pages/. Pages are the main index files, that are fairly specifc, and components are reusable UI elements, that are a bit more generic.

We have an npm script that uses babel to compile the contents of /src from es6 to /dist as es5. These are built to run on the server and client.

We use webpack to package our client side files into /public, which is handled in webpack.config.js

We use react router to handle the site structure, which live in /src/avocacy-main.js and /src/encrypt-main.js

We use node to run our server, which is handled in app.js

encrypt pages are handled a bit differently from the rest. While the standard site uses /src/advocacy-main.js for pretty much all the generating and packaging of files, routes, and source. Encrypt uses /src/encrypt-app.js to package client side files, it uses /src/encrypt-main.js and /src/lib/react-server-rooute.js to handle server side rendering.
